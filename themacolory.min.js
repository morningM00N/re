let themaInfor=[];function showString(e){console.log("==="+e+"===")}let sortPriority=[3,4,5,0,1,2],sortPriDesc=[!0,!0,!0,!0,!0,!0];function sortTuple(e,t){for(let n=0;n<sortPriority.length;n++){let r=e[sortPriority[n]],o=t[sortPriority[n]];if(sortPriority[n]>=3&&(1==isNaN(r)&&(r=0),1==isNaN(o)&&(o=0)),r>o)return 1==sortPriDesc[n]?-1:1;if(r<o)return 1==sortPriDesc[n]?1:-1}return 0}let vecLocName=[];const LOCATION=0,SHOP=1,TITLE=2,RATE=3,DIFF=4,COUNT=5;function loadFromFile(){let e,t,n=new XMLHttpRequest;n.open("GET","./colory/curScore.txt",!1),n.setRequestHeader("Content-Type","text/html;charset=utf-8"),n.onreadystatechange=function(){4===n.readyState&&(200!==n.status&&0!=n.status||(e=n.responseText))},n.send(null),t=e.split(/[\n\r]/),document.getElementById("date").innerHTML="data for "+t[0];let r=null;for(let e=1;e<t.length;e++){if(0==t[e].length)continue;if("L:"==t[e].substr(0,2)){r=t[e].substr(2),vecLocName.push(r);continue}let n=t[e].split("|"),o=n[0],a=1;for(;;){let e=n[a++],t=n[a++],i=n[a++],l=n[a++],m=[];if(m[LOCATION]=r,m[SHOP]=o,m[TITLE]=e,m[RATE]=Number(t),m[DIFF]=Number(i),m[COUNT]=Number(l),themaInfor.push(m),a>=n.length)break}}}loadFromFile();let satisfiedEntries,mapLoc={},queryLoc={};function funcDrawInit(){let e=0,t=10,n=0,r=1e5,o=0,a=10;for(let i=0;i<themaInfor.length;i++)e<themaInfor[i][RATE]&&(e=themaInfor[i][RATE]),t>themaInfor[i][RATE]&&(t=themaInfor[i][RATE]),n<themaInfor[i][COUNT]&&(n=themaInfor[i][COUNT]),r>themaInfor[i][COUNT]&&(r=themaInfor[i][COUNT]),o<themaInfor[i][DIFF]&&(o=themaInfor[i][DIFF]),a>themaInfor[i][DIFF]&&(a=themaInfor[i][DIFF]);let i=document.getElementById("tdLocationContents");for(let e=0;e<vecLocName.length;e++){let t=document.createElement("input");t.type="checkbox",t.onclick=function(t){1==t.target.checked?queryLoc[vecLocName[e]]=!0:queryLoc[vecLocName[e]]=!1},0==e&&(queryLoc[vecLocName[e]]=!0,t.checked=!0),i.appendChild(t);let n=document.createElement("span");n.innerHTML=vecLocName[e]+" ",i.appendChild(n),e%6==5&&(i.appendChild(document.createElement("br")),i.appendChild(document.createElement("br")))}document.getElementById("spanRateMin").innerHTML=t,document.getElementById("spanRateMax").innerHTML=e,document.getElementById("spanDiffMin").innerHTML=a,document.getElementById("spanDiffMax").innerHTML=o,document.getElementById("spanCountMin").innerHTML=r,document.getElementById("spanCountMax").innerHTML=n;{let n=document.getElementById("rangeRateMin");n.min=10*t,n.max=10*e,n.value=10*t;let r=document.getElementById("rangeRateMax");r.min=10*t,r.max=10*e,r.value=10*e}{let e=document.getElementById("rangeDiffMin");e.min=1*a,e.max=1*o,e.value=1*a;let t=document.getElementById("rangeDiffMax");t.min=1*a,t.max=1*o,t.value=1*o}{let e=document.getElementById("rangeCountMin");e.min=1*r,e.max=1*n,e.value=1*r;let t=document.getElementById("rangeCountMax");t.min=1*r,t.max=1*n,t.value=1*n}}function funcInputVal(e,t){let n=prompt("value"),r=document.getElementById(e.id.replace("span","range"));1==isNaN(n)||n*t<r.min||n*t>r.max||(e.innerHTML=n,r.value=n*t)}function funcChangeVal(e,t){document.getElementById(e.id.replace("range","span")).innerHTML=e.value/t}function funcSetSortPri(e){let t=sortPriority[0];(sortPriority=[0])[0]=t,sortPriority[0]==e?sortPriDesc[0]=!sortPriDesc[0]:(sortPriority[0]=e,sortPriDesc[0]=!0),funcDrawResult()}funcDrawInit();let headContents=["위치","매장","테마","평점","난이도","후기수"];function funcDrawResult(){let e=document.getElementById("tabResult");for(;e.childElementCount>0;)e.removeChild(e.children[0]);if(0==satisfiedEntries.length)return void alert("해당 테마가 없습니다!");satisfiedEntries.sort(sortTuple);let t=document.createElement("tr");t.className="result";for(let e=0;e<headContents.length;e++){let n=document.createElement("th");n.className="result",sortPriority[0]==e?1==sortPriDesc[0]?n.innerHTML=headContents[e]+"↓":n.innerHTML=headContents[e]+"↑":n.innerHTML=headContents[e],n.onclick=function(){funcSetSortPri(e)},t.appendChild(n)}e.appendChild(t);for(let t=0;t<satisfiedEntries.length&&100!=t;t++){let n=document.createElement("tr");n.className="result",e.appendChild(n);for(let e=0;e<=COUNT;e++){let r=document.createElement("td");r.className="result",r.innerHTML=satisfiedEntries[t][e],n.appendChild(r)}}}function funcEval(){let e=Number(document.getElementById("spanRateMin").innerHTML),t=Number(document.getElementById("spanRateMax").innerHTML),n=Number(document.getElementById("spanDiffMin").innerHTML),r=Number(document.getElementById("spanDiffMax").innerHTML),o=Number(document.getElementById("spanCountMin").innerHTML),a=Number(document.getElementById("spanCountMax").innerHTML);if(t<e||a<o||r<n)alert("입력을 확인해주세요!");else{satisfiedEntries=[];for(let i=0;i<themaInfor.length;i++)themaInfor[i][RATE]<e||themaInfor[i][RATE]>t||themaInfor[i][COUNT]<o||themaInfor[i][COUNT]>a||themaInfor[i][DIFF]<n||themaInfor[i][DIFF]>r||(0==e&&10==t||1!=isNaN(themaInfor[i][RATE]))&&(0==n&&10==r||1!=isNaN(themaInfor[i][DIFF]))&&1==queryLoc[themaInfor[i][LOCATION]]&&satisfiedEntries.push(themaInfor[i]);funcDrawResult()}}
